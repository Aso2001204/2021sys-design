```uml
@startuml



opt 商品購入
 ユーザー -> WEBサーバー:キーワードを送信
 WEBサーバー -> DBサーバー:キーワード送信
 DBサーバー -> DBサーバー:キーワードを基にSQLで検索
 alt 商品を見つけた
  WEBサーバー -> ユーザー:次の画面を表示
 else 商品がなかった
  WEBサーバー -> ユーザー:エラー表示
  WEBサーバー -> ユーザー:フォームを送信
 end
 ユーザー -> WEBサーバー:必要情報を送信
 WEBサーバー -> DBサーバー:必要情報を送信
 DBサーバー -> DBサーバー :必要情報を登録
 alt 漏れがない
  DBサーバー -> WEBサーバー:支払情報画面のURLを送信
  WEBサーバー -> ユーザー:URLの画面を表示
 else 漏れがある
  DBサーバー -> WEBサーバー:エラーメッセージを送信
  WEBサーバー -> ユーザー:エラーメッセージを表示
 end
 ユーザー -> WEBサーバー:支払情報を送信
 WEBサーバー -> DBサーバー:支払情報を送信
 DBサーバー -> DBサーバー:支払情報を登録
 alt 漏れがない
  DBサーバー -> WEBサーバー:確認画面のURLを送信
  WEBサーバー -> ユーザー:確認画面を表示
 else 漏れがある
  DBサーバー -> WEBサーバー:エラーメッセージを送信
  WEBサーバー -> ユーザー:エラーメッセージを表示
  WEBサーバー -> ユーザー:フォームを送信
 end
 ユーザー -> WEBサーバー:購入完了を送信
 WEBサーバー -> DBサーバー:購入完了を送信
 DBサーバー -> DBサーバー:情報を登録
 DBサーバー -> WEBサーバー:完了通知
 WEBサーバー -> ユーザー:完了画面を表示
end

opt カートの中
 ユーザー -> WEBサーバー:リクエスト要求
 WEBサーバー -> DBサーバー:リクエスト送信
 DBサーバー -> DBサーバー:ユーザー名でSQL
 DBサーバー -> WEBサーバー:結果送信
 WEBサーバー -> ユーザー:結果を表示
end

opt 登録情報
 ユーザー -> WEBサーバー:リクエスト要求
 WEBサーバー -> DBサーバー:リクエスト送信
 DBサーバー -> DBサーバー:ユーザー名でSQL
 DBサーバー -> WEBサーバー:結果を送信
 WEBサーバー -> ユーザー:結果を表示
 opt 登録情報変更
  ユーザー -> WEBサーバー:リクエスト要求
  WEBサーバー -> DBサーバー:リクエスト送信
  DBサーバー -> DBサーバー:変更入力画面を作成
  DBサーバー -> WEBサーバー:変更入力画面のURLを送信
  WEBサーバー -> ユーザー:変更入力画面を送信
  ユーザー -> WEBサーバー:変更内容を送信
  WEBサーバー -> DBサーバー:変更内容を送信
  DBサーバー -> DBサーバー:変更内容を登録
  DBサーバー -> WEBサーバー:完了通知
  WEBサーバー -> ユーザー:完了通知
 end
end
@enduml
```
