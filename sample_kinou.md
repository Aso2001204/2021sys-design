```uml
@startuml

opt 画面表示
 ユーザー -> WEBサーバー:サイト起動のリクエスト
 WEBサーバー -> DBサーバー:リクエスト要求
 DBサーバー -> DBサーバー:人気商品をSQLで検索
 DBサーバー -> WEBサーバー:結果送信
 WEBサーバー -> ユーザー:結果を画面に表示
end

opt 検索
 ユーザー -> WEBサーバー:キーワードを送信
 WEBサーバー -> DBサーバー:キーワードを送信
 DBサーバー -> DBサーバー:キーワードを基にSQLで検索
 DBサーバー -> WEBサーバー:結果を送信
 alt 成功
  WEBサーバー -> ユーザー:商品を表示
 else 失敗
  WEBサーバー -> ユーザー:エラーメッセージを表示
  WEBサーバー -> ユーザー:もう一度入力するように案内
 end
end

opt 商品購入
 ユーザー -> WEBサーバー:キーワードを送信
 WEBサーバー -> DBサーバー:キーワード送信
 DBサーバー -> DBサーバー:キーワードを基にSQLで検索
 alt 商品を見つけた
  WEBサーバー -> ユーザー:次の画面を表示
 else 商品がなかった
  WEBサーバー -> ユーザー:エラー表示
  WEBサーバー -> ユーザー:フォームを送信
 end
 ユーザー -> WEBサーバー:必要情報を送信
 WEBサーバー -> DBサーバー:必要情報を送信
 DBサーバー -> DBサーバー :必要情報を登録
 alt 漏れがない
  DBサーバー -> WEBサーバー:支払情報画面のURLを送信
  WEBサーバー -> ユーザー:URLの画面を表示
 else 漏れがある
  DBサーバー -> WEBサーバー:エラーメッセージを送信
  WEBサーバー -> ユーザー:エラーメッセージを表示
 end
 ユーザー -> WEBサーバー:支払情報を送信
 WEBサーバー -> DBサーバー:支払情報を送信
 DBサーバー -> DBサーバー:支払情報を登録
 alt 漏れがない
  DBサーバー -> WEBサーバー:確認画面のURLを送信
  WEBサーバー -> ユーザー:確認画面を表示
 else 漏れがある
  DBサーバー -> WEBサーバー:エラーメッセージを送信
  WEBサーバー -> ユーザー:エラーメッセージを表示
  WEBサーバー -> ユーザー:フォームを送信
 end
 ユーザー -> WEBサーバー:購入完了を送信
 WEBサーバー -> DBサーバー:購入完了を送信
 DBサーバー -> DBサーバー:情報を登録
 DBサーバー -> WEBサーバー:完了通知
 WEBサーバー -> ユーザー:完了画面を表示
end

opt カートの中
 ユーザー -> WEBサーバー:リクエスト要求
 WEBサーバー -> DBサーバー:リクエスト送信
 DBサーバー -> DBサーバー:ユーザー名でSQL
 DBサーバー -> WEBサーバー:結果送信
 WEBサーバー -> ユーザー:結果を表示
end

opt 登録情報

end
@enduml
```
